{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/suphachabharnigrodhananda/Desktop/6080/ass3/frontend/src/elements/gameBoard.jsx\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport '../App.css';\nimport propTypes from 'prop-types';\nimport Cookies from 'universal-cookie';\nimport { Link } from 'react-router-dom';\nimport { Button } from '../components/Button.styles';\nimport { Quizname } from '../components/Quizname.style';\n\nfunction GameBoard({\n  quiz,\n  changeAlert,\n  forceLogout\n}) {\n  _s();\n\n  const cookies = new Cookies();\n  const [show, setShow] = React.useState(true);\n  const [name, setName] = React.useState(quiz.name);\n  const [thumbnail, setThumbnail] = React.useState(quiz.thumbnail);\n  const [questions, setQuestions] = React.useState(quiz.questions);\n  const [nQuestions, setNQuestions] = React.useState(0);\n  const [time, setTime] = React.useState(0);\n  const [session, setSession] = React.useState(quiz.active);\n  const [hasSession, setHasSession] = React.useState(quiz.active !== null);\n  const [position, setPosition] = React.useState(-1);\n  const [oldSessions, setOldSessions] = React.useState([]);\n  const [answerAvailable, setAnswerAvailable] = React.useState(false);\n  const initialisation = React.useRef(true);\n  const [popupArea, setPopup] = React.useState(null);\n  const [history, setHistory] = React.useState(null);\n  const [prevSession, setPrevSession] = React.useState(null); // close button for the popup and alert\n\n  const closeBtn = /*#__PURE__*/React.createElement('button', {\n    onClick: () => {\n      setPopup(null);\n    }\n  }, 'Close'); // fetch all if the information of the quiz\n\n  const getInfo = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then(result => {\n          setName(result.name);\n          setQuestions(result.questions);\n          setNQuestions(result.questions.length);\n          setThumbnail(result.thumbnail);\n          let timeTmp = 0;\n          result.questions.forEach(q => {\n            timeTmp += q.time;\n          });\n          setTime(timeTmp);\n\n          if (!hasSession && result.active) {\n            setSession(result.active);\n            setHasSession(true);\n          } else if (hasSession && !result.active) {\n            setPrevSession(session);\n            setSession(null);\n            setHasSession(false);\n          }\n\n          setOldSessions(result.oldSessions);\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  }; // fetch start session of the quiz\n\n\n  const startSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/start', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        getInfo();\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  }; // fetch stop question of the quiz\n\n\n  const stopSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/end', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        getInfo();\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  }; // fetch delete function of the game\n\n\n  const deleteGame = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'DELETE',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then(result => {\n          changeAlert('success', 'You have deleted \"' + name + '\"');\n          setShow(false);\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  }; // copy url and send to another player\n\n\n  const copySession = () => {\n    navigator.clipboard.writeText('http://localhost:3000/join/' + session);\n  }; // show the url link\n\n\n  const showShareLink = () => {\n    setPopup( /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"popup\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"You have started a session for \\\"\", name, \"\\\"!\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Session ID: \", session, \" \", /*#__PURE__*/_jsxDEV(Button, {\n              title: \"Copy link\",\n              click: copySession\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 157,\n              columnNumber: 38\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 155,\n          columnNumber: 11\n        }, this), closeBtn]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 9\n      }, this)\n    }, void 0, false));\n  }; // fetch the status of the game\n\n\n  const updateSessionStatus = () => {\n    fetch('http://localhost:5005/admin/session/' + session + '/status', {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then(result => {\n          const i = result.results.position;\n          const available = result.results.answerAvailable;\n          setQuestions(result.results.questions);\n          setPosition(i);\n\n          if (i >= result.results.questions.length) {\n            setPrevSession(session);\n            setSession(null);\n            setHasSession(false);\n          } else if (i >= 0 && !available) {\n            const timeout = result.results.questions[i].time * 1000 - (new Date() - new Date(result.results.isoTimeLastQuestionStarted));\n            setTimeout(() => {\n              setAnswerAvailable(true);\n            }, timeout);\n          }\n\n          setAnswerAvailable(available);\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  }; // fetch the advance session\n\n\n  const advanceSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/advance', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        updateSessionStatus();\n        console.log(questions[0]);\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n    updateSessionStatus();\n  }; // use useEffect from the fetch getting all information\n\n\n  React.useEffect(() => {\n    getInfo(true);\n  }, []); // use useEffect to see the session of the game\n\n  React.useEffect(() => {\n    if (session) {\n      updateSessionStatus();\n    }\n\n    if (initialisation.current) {\n      initialisation.current = false;\n    } else if (hasSession) {\n      showShareLink();\n    } else {\n      setPopup( /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"popup\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"The session for \\\"\", name, \"\\\" has ended.\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 248,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: '/results/' + prevSession,\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                title: \"See results\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 252,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this), closeBtn]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this)\n      }, void 0, false));\n    }\n  }, [hasSession]);\n  React.useEffect(() => {\n    if (oldSessions.length > 0) {\n      const options = oldSessions.map(s => {\n        return /*#__PURE__*/_jsxDEV(\"option\", {\n          to: '/results/' + s,\n          children: s\n        }, s, false, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 16\n        }, this);\n      });\n      setHistory( /*#__PURE__*/_jsxDEV(\"select\", {\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          children: \"View previous session results\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 269,\n          columnNumber: 11\n        }, this), options]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 9\n      }, this));\n    }\n  }, [oldSessions]); // show thumbnail\n\n  let img = null;\n\n  if (thumbnail) {\n    img = /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: thumbnail\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 16\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 279,\n      columnNumber: 11\n    }, this);\n  }\n\n  let buttons = null;\n  let statusArea = null;\n\n  if (hasSession) {\n    if (position < 0) {\n      statusArea = /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"The game is not started.\", /*#__PURE__*/_jsxDEV(Button, {\n            title: \"Start\",\n            name: \"start\",\n            click: advanceSession\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 290,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }, this)\n      }, void 0, false);\n    } else if (!answerAvailable) {\n      statusArea = /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"Question \", position + 1, \" is released. You can advance the game after the answer is released.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 297,\n          columnNumber: 11\n        }, this)\n      }, void 0, false);\n    } else {\n      statusArea = /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [\"The answer of question \", position + 1, \" is released.\", /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: advanceSession,\n            children: \"Next question\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 307,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 11\n        }, this)\n      }, void 0, false);\n    }\n\n    buttons = /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [statusArea, /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          title: \"Share link\",\n          click: () => {\n            showShareLink();\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 316,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          title: \"Stop session\",\n          click: stopSession\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 315,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  } else {\n    buttons = /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Button, {\n        title: \"Create session\",\n        id: \"session\",\n        click: startSession\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 324,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: '/edit/' + quiz.id,\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          title: \"Edit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 328,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 325,\n        columnNumber: 9\n      }, this), history, /*#__PURE__*/_jsxDEV(Button, {\n        title: \"Delete\",\n        click: deleteGame\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 331,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  if (show) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"list-group\",\n        children: /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"list-group-item\",\n          children: [/*#__PURE__*/_jsxDEV(Quizname, {\n            title: quiz.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Number of questions: \", nQuestions]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Time: \", (time / 60).toFixed(1), \" mins\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 13\n          }, this), img, buttons, popupArea]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }, this)\n    }, void 0, false);\n  } else {\n    return null;\n  }\n}\n\n_s(GameBoard, \"hw2geJrNSTBGpRscVFtCch+qgYY=\");\n\n_c = GameBoard;\nGameBoard.propTypes = {\n  quiz: propTypes.object,\n  changeAlert: propTypes.func,\n  forceLogout: propTypes.func\n};\nexport default GameBoard;\n\nvar _c;\n\n$RefreshReg$(_c, \"GameBoard\");","map":{"version":3,"sources":["/Users/suphachabharnigrodhananda/Desktop/6080/ass3/frontend/src/elements/gameBoard.jsx"],"names":["React","propTypes","Cookies","Link","Button","Quizname","GameBoard","quiz","changeAlert","forceLogout","cookies","show","setShow","useState","name","setName","thumbnail","setThumbnail","questions","setQuestions","nQuestions","setNQuestions","time","setTime","session","setSession","active","hasSession","setHasSession","position","setPosition","oldSessions","setOldSessions","answerAvailable","setAnswerAvailable","initialisation","useRef","popupArea","setPopup","history","setHistory","prevSession","setPrevSession","closeBtn","createElement","onClick","getInfo","fetch","id","method","headers","Accept","Authorization","get","then","data","status","json","result","length","timeTmp","forEach","q","error","startSession","stopSession","deleteGame","copySession","navigator","clipboard","writeText","showShareLink","updateSessionStatus","i","results","available","timeout","Date","isoTimeLastQuestionStarted","setTimeout","advanceSession","console","log","useEffect","current","options","map","s","img","buttons","statusArea","toFixed","object","func"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../App.css'\nimport propTypes from 'prop-types';\nimport Cookies from 'universal-cookie';\nimport {\n  Link\n} from 'react-router-dom';\nimport { Button } from '../components/Button.styles';\nimport { Quizname } from '../components/Quizname.style';\nfunction GameBoard ({ quiz, changeAlert, forceLogout }) {\n  const cookies = new Cookies();\n  const [show, setShow] = React.useState(true);\n  const [name, setName] = React.useState(quiz.name);\n  const [thumbnail, setThumbnail] = React.useState(quiz.thumbnail);\n  const [questions, setQuestions] = React.useState(quiz.questions);\n  const [nQuestions, setNQuestions] = React.useState(0);\n  const [time, setTime] = React.useState(0);\n  const [session, setSession] = React.useState(quiz.active);\n  const [hasSession, setHasSession] = React.useState(quiz.active !== null);\n  const [position, setPosition] = React.useState(-1);\n  const [oldSessions, setOldSessions] = React.useState([]);\n  const [answerAvailable, setAnswerAvailable] = React.useState(false);\n  const initialisation = React.useRef(true);\n  const [popupArea, setPopup] = React.useState(null);\n  const [history, setHistory] = React.useState(null);\n  const [prevSession, setPrevSession] = React.useState(null);\n\n  // close button for the popup and alert\n  const closeBtn = React.createElement('button', {\n    onClick: () => { setPopup(null); }\n  }, 'Close');\n\n  // fetch all if the information of the quiz\n  const getInfo = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then((result) => {\n          setName(result.name);\n          setQuestions(result.questions);\n          setNQuestions(result.questions.length);\n          setThumbnail(result.thumbnail);\n          let timeTmp = 0;\n          result.questions.forEach((q) => {\n            timeTmp += q.time;\n          });\n          setTime(timeTmp);\n          if (!hasSession && result.active) {\n            setSession(result.active);\n            setHasSession(true);\n          } else if (hasSession && !result.active) {\n            setPrevSession(session);\n            setSession(null);\n            setHasSession(false);\n          }\n          setOldSessions(result.oldSessions);\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  // fetch start session of the quiz\n  const startSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/start', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        getInfo();\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  // fetch stop question of the quiz\n  const stopSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/end', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        getInfo();\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  // fetch delete function of the game\n  const deleteGame = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'DELETE',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then((result) => {\n          changeAlert('success', 'You have deleted \"' + name + '\"');\n          setShow(false);\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  // copy url and send to another player\n  const copySession = () => {\n    navigator.clipboard.writeText('http://localhost:3000/join/' + session);\n  };\n\n  // show the url link\n  const showShareLink = () => {\n    setPopup(\n      <>\n        <div\n          className='popup'\n        >\n          <div>\n            <p>You have started a session for &quot;{name}&quot;!</p>\n            <p>Session ID: {session} <Button title=\"Copy link\" click={copySession} /></p>\n          </div>\n          {closeBtn}\n        </div>\n      </>\n    );\n  };\n\n  // fetch the status of the game\n  const updateSessionStatus = () => {\n    fetch('http://localhost:5005/admin/session/' + session + '/status', {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then((result) => {\n          const i = result.results.position;\n          const available = result.results.answerAvailable;\n          setQuestions(result.results.questions);\n          setPosition(i);\n          if (i >= result.results.questions.length) {\n            setPrevSession(session);\n            setSession(null);\n            setHasSession(false);\n          } else if (i >= 0 && !available) {\n            const timeout = result.results.questions[i].time * 1000 - (new Date() - new Date(result.results.isoTimeLastQuestionStarted));\n            setTimeout(() => {\n              setAnswerAvailable(true);\n            }, timeout);\n          }\n          setAnswerAvailable(available);\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  // fetch the advance session\n  const advanceSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/advance', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        updateSessionStatus();\n        console.log(questions[0]);\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n    updateSessionStatus();\n  };\n\n  // use useEffect from the fetch getting all information\n  React.useEffect(() => {\n    getInfo(true);\n  }, []);\n\n  // use useEffect to see the session of the game\n  React.useEffect(() => {\n    if (session) {\n      updateSessionStatus();\n    }\n    if (initialisation.current) {\n      initialisation.current = false;\n    } else if (hasSession) {\n      showShareLink();\n    } else {\n      setPopup(\n        <>\n          <div\n            className='popup'\n          >\n            <div>\n              <p>The session for &quot;{name}&quot; has ended.</p>\n              <Link\n                to={'/results/' + prevSession}\n              >\n                <Button title=\"See results\" />\n              </Link>\n            </div>\n            {closeBtn}\n          </div>\n        </>\n      );\n    }\n  }, [hasSession]);\n\n  React.useEffect(() => {\n    if (oldSessions.length > 0) {\n      const options = oldSessions.map((s) => {\n        return <option key={s} to={'/results/' + s}>{s}</option>;\n      });\n      setHistory(\n        <select>\n          <option>View previous session results</option>\n          {options}\n        </select>\n      );\n    }\n  }, [oldSessions]);\n\n  // show thumbnail\n  let img = null;\n  if (thumbnail) {\n    img = <div><img src={thumbnail} /></div>;\n  }\n\n  let buttons = null;\n  let statusArea = null;\n  if (hasSession) {\n    if (position < 0) {\n      statusArea = (\n        <>\n          <div>\n            The game is not started.\n            <Button title=\"Start\" name=\"start\" click={advanceSession} />\n          </div>\n        </>\n      );\n    } else if (!answerAvailable) {\n      statusArea = (\n        <>\n          <div>\n            Question {position + 1} is released. You can advance the game after the answer is released.\n          </div>\n        </>\n      );\n    } else {\n      statusArea = (\n        <>\n          <div>\n            The answer of question {position + 1} is released.\n            <button onClick={advanceSession}>Next question</button>\n          </div>\n        </>\n      );\n    }\n    buttons = (\n      <>\n        {statusArea}\n        <div>\n          <Button title=\"Share link\" click={() => { showShareLink() }} />\n          <Button title=\"Stop session\" click={stopSession} />\n        </div>\n      </>\n    );\n  } else {\n    buttons = (\n      <>\n        <Button title=\"Create session\" id=\"session\" click={startSession} />\n        <Link\n          to={'/edit/' + quiz.id}\n        >\n          <Button title=\"Edit\" />\n        </Link>\n        {history}\n        <Button title=\"Delete\" click={deleteGame} />\n      </>\n    );\n  }\n\n  if (show) {\n    return (\n      <>\n        <ul className=\"list-group\">\n          <li className=\"list-group-item\">\n            <Quizname title={quiz.name} />\n            <p>Number of questions: {nQuestions}</p>\n            <p>Time: {(time / 60).toFixed(1)} mins</p>\n            {img}\n            {buttons}\n            {popupArea}\n          </li>\n        </ul>\n      </>\n    );\n  } else {\n    return null;\n  }\n}\n\nGameBoard.propTypes = {\n  quiz: propTypes.object,\n  changeAlert: propTypes.func,\n  forceLogout: propTypes.func\n};\n\nexport default GameBoard;\n"]},"metadata":{},"sourceType":"module"}