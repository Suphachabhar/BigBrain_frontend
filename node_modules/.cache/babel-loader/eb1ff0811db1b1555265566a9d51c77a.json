{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/suphachabharnigrodhananda/Desktop/6080/ass3/frontend/src/elements/gameBoard.jsx\",\n    _s = $RefreshSig$();\n\nimport React from 'react';\nimport { BaseButton, PrimaryButton } from '../components/Button.styles';\nimport { Popup } from '../components/Layout.styles';\nimport propTypes from 'prop-types';\nimport Cookies from 'universal-cookie';\nimport { Link } from 'react-router-dom';\n\nfunction GameBoard({\n  quiz,\n  changeAlert,\n  forceLogout\n}) {\n  _s();\n\n  const cookies = new Cookies();\n  const [show, setShow] = React.useState(true);\n  const [name, setName] = React.useState(quiz.name);\n  const [questions, setNameQ] = React.useState(quiz.questions);\n  const [thumbnail, setThumbnail] = React.useState(quiz.thumbnail);\n  const [nQuestions, setNQuestions] = React.useState(0);\n  const [time, setTime] = React.useState(0);\n  const [session, setSession] = React.useState(quiz.active);\n  const [hasSession, setHasSession] = React.useState(quiz.active !== null);\n  const initialisation = React.useRef(true);\n  const [popupArea, setPopup] = React.useState(null);\n  const closeBtn = /*#__PURE__*/React.createElement('button', {\n    onClick: () => {\n      setPopup(null);\n    }\n  }, 'Close');\n\n  const getInfo = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then(result => {\n          setName(result.name);\n          setNQuestions(result.questions.length);\n          setThumbnail(result.thumbnail);\n          let timeTmp = 0;\n          result.questions.forEach(q => {\n            timeTmp += q.time;\n          });\n          setTime(timeTmp);\n\n          if (!hasSession && result.active) {\n            setSession(result.active);\n            setHasSession(true);\n          } else if (hasSession && !result.active) {\n            setHasSession(false);\n          }\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  const startSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/start', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        getInfo();\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  const stopSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/end', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        getInfo();\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  const showQuestion = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'PUT',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then(data => {\n          changeAlert('success', 'You update a question!');\n          const result = fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n            method: 'GET',\n            headers: {\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n              'Authorization': 'Token ' + token\n            }\n          }).then(data => {\n            if (data.status === 200) {\n              setNameQ(result.nameQ);\n            }\n          });\n        });\n      } else if (data.status === 400) {\n        changeAlert('danger', data.error);\n      } else if (data.status === 403) {\n        changeAlert('danger', data.error);\n      } else {\n        forceLogout();\n      }\n    });\n  };\n\n  const deleteGame = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'DELETE',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then(result => {\n          changeAlert('success', 'You have deleted \"' + name + '\"');\n          setShow();\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then(result => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n\n  const copySession = () => {\n    navigator.clipboard.writeText('http://localhost:3000/join/' + session);\n  };\n\n  React.useEffect(() => {\n    getInfo(true);\n  }, []);\n  React.useEffect(() => {\n    console.log(initialisation.current);\n\n    if (initialisation.current) {\n      initialisation.current = false;\n    } else if (hasSession) {\n      setPopup( /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Popup,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"You have started a session for \\\"\", name, \"\\\"!\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 177,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Session ID: \", session, \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: copySession,\n                children: \"Copy link\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 178,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 13\n          }, this), closeBtn]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 11\n        }, this)\n      }, void 0, false));\n    } else {\n      setPopup( /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Popup,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"You have stopped the session for \\\"\", name, \"\\\"!\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(Link, {\n              to: '/results/' + session,\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: BaseButton,\n                children: \"See results\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 195,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 192,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 13\n          }, this), closeBtn]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this)\n      }, void 0, false));\n    }\n  }, [hasSession]);\n  let img = null;\n\n  if (thumbnail) {\n    img = /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"img\", {\n        src: thumbnail\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 16\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 210,\n      columnNumber: 11\n    }, this);\n  }\n\n  let buttons = null;\n\n  if (hasSession) {\n    buttons = /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: stopSession,\n        children: \"Stop\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this)\n    }, void 0, false);\n  } else {\n    buttons = /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startSession,\n        children: \"Start\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: '/edit/' + quiz.id,\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          className: PrimaryButton,\n          children: \"Edit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: deleteGame,\n        children: \"Delete\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n  if (show) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"list-group\",\n        children: /*#__PURE__*/_jsxDEV(\"li\", {\n          className: \"list-group-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: quiz.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: quiz.nameQ\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 257,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Number of questions: \", nQuestions]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Time: \", (time / 60).toFixed(1), \" mins\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 13\n          }, this), img, buttons, popupArea]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 252,\n        columnNumber: 9\n      }, this)\n    }, void 0, false);\n  } else {\n    return null;\n  }\n}\n\n_s(GameBoard, \"TGqy063emWPLSZbO3av7pOsXZnQ=\");\n\n_c = GameBoard;\nGameBoard.propTypes = {\n  quiz: propTypes.object,\n  changeAlert: propTypes.func,\n  forceLogout: propTypes.func\n};\nexport default GameBoard;\n\nvar _c;\n\n$RefreshReg$(_c, \"GameBoard\");","map":{"version":3,"sources":["/Users/suphachabharnigrodhananda/Desktop/6080/ass3/frontend/src/elements/gameBoard.jsx"],"names":["React","BaseButton","PrimaryButton","Popup","propTypes","Cookies","Link","GameBoard","quiz","changeAlert","forceLogout","cookies","show","setShow","useState","name","setName","questions","setNameQ","thumbnail","setThumbnail","nQuestions","setNQuestions","time","setTime","session","setSession","active","hasSession","setHasSession","initialisation","useRef","popupArea","setPopup","closeBtn","createElement","onClick","getInfo","fetch","id","method","headers","Accept","Authorization","get","then","data","status","json","result","length","timeTmp","forEach","q","error","startSession","stopSession","showQuestion","token","nameQ","deleteGame","copySession","navigator","clipboard","writeText","useEffect","console","log","current","img","buttons","toFixed","object","func"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { BaseButton, PrimaryButton } from '../components/Button.styles';\nimport { Popup } from '../components/Layout.styles';\nimport propTypes from 'prop-types';\nimport Cookies from 'universal-cookie';\nimport {\n  Link\n} from 'react-router-dom';\n\nfunction GameBoard ({ quiz, changeAlert, forceLogout }) {\n  const cookies = new Cookies();\n  const [show, setShow] = React.useState(true);\n  const [name, setName] = React.useState(quiz.name);\n  const [questions, setNameQ] = React.useState(quiz.questions);\n  const [thumbnail, setThumbnail] = React.useState(quiz.thumbnail);\n  const [nQuestions, setNQuestions] = React.useState(0);\n  const [time, setTime] = React.useState(0);\n  const [session, setSession] = React.useState(quiz.active);\n  const [hasSession, setHasSession] = React.useState(quiz.active !== null);\n  const initialisation = React.useRef(true);\n  const [popupArea, setPopup] = React.useState(null);\n\n  const closeBtn = React.createElement('button', {\n    onClick: () => { setPopup(null); }\n  }, 'Close');\n\n  const getInfo = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then((result) => {\n          setName(result.name);\n          setNQuestions(result.questions.length);\n          setThumbnail(result.thumbnail);\n          let timeTmp = 0;\n          result.questions.forEach((q) => {\n            timeTmp += q.time;\n          });\n          setTime(timeTmp);\n          if (!hasSession && result.active) {\n            setSession(result.active);\n            setHasSession(true);\n          } else if (hasSession && !result.active) {\n            setHasSession(false);\n          }\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n  const startSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/start', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        getInfo();\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n  const stopSession = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id + '/end', {\n      method: 'POST',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        getInfo();\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n  const showQuestion = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'PUT',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then((data) => {\n          changeAlert('success', 'You update a question!');\n          const result = fetch('http://localhost:5005/admin/quiz/' + quiz.id,{\n            method: 'GET',\n            headers:{\n              'Accept': 'application/json',\n              'Content-Type': 'application/json',\n              'Authorization': 'Token ' + token\n            },\n          }).then( (data => {\n            if(data.status === 200){\n              setNameQ(result.nameQ);\n            }\n          }))\n        });\n      } else if (data.status === 400) {\n        changeAlert('danger', data.error);\n      } else if (data.status === 403) {\n        changeAlert('danger', data.error);\n      } else {\n        forceLogout();\n      }\n    });\n  };\n  const deleteGame = () => {\n    fetch('http://localhost:5005/admin/quiz/' + quiz.id, {\n      method: 'DELETE',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n        Authorization: 'Bearer ' + cookies.get('token')\n      }\n    }).then(data => {\n      if (data.status === 200) {\n        data.json().then((result) => {\n          changeAlert('success', 'You have deleted \"' + name + '\"');\n          setShow();\n        });\n      } else if (data.status === 403) {\n        forceLogout();\n      } else {\n        data.json().then((result) => {\n          changeAlert('danger', result.error);\n        });\n      }\n    });\n  };\n  const copySession = () => {\n    navigator.clipboard.writeText('http://localhost:3000/join/' + session);\n  };\n\n  React.useEffect(() => {\n    getInfo(true);\n  }, []);\n  React.useEffect(() => {\n    console.log(initialisation.current);\n    if (initialisation.current) {\n      initialisation.current = false;\n    } else if (hasSession) {\n      setPopup(\n        <>\n          <div\n            className={Popup}\n          >\n            <div>\n              <p>You have started a session for &quot;{name}&quot;!</p>\n              <p>Session ID: {session} <button onClick={copySession}>Copy link</button></p>\n            </div>\n            {closeBtn}\n          </div>\n        </>\n      );\n    } else {\n      setPopup(\n        <>\n          <div\n            className={Popup}\n          >\n            <div>\n              <p>You have stopped the session for &quot;{name}&quot;!</p>\n              <Link\n                to={'/results/' + session}\n              >\n                <button\n                  className = { BaseButton }>\n                    See results\n                </button>\n              </Link>\n            </div>\n            {closeBtn}\n          </div>\n        </>\n      );\n    }\n  }, [hasSession]);\n\n  let img = null;\n  if (thumbnail) {\n    img = <div><img src={thumbnail} /></div>;\n  }\n\n  let buttons = null;\n  if (hasSession) {\n    buttons = (\n      <>\n        <button\n          onClick={stopSession}\n        >\n          Stop\n        </button>\n      </>\n    );\n  } else {\n    buttons = (\n      <>\n        <button\n          onClick={startSession}\n        >\n          Start\n        </button>\n        <Link\n          to={'/edit/' + quiz.id}\n        >\n          <button\n            className = { PrimaryButton }>\n            Edit\n          </button>\n        </Link>\n        <button\n          onClick={deleteGame}\n        >\n          Delete\n        </button>\n      </>\n    );\n  }\n\n  if (show) {\n    return (\n      <>\n        <ul className=\"list-group\">\n          <li className=\"list-group-item\">\n            <h3>\n              {quiz.name}\n            </h3>\n            <div>{quiz.nameQ}</div>\n            <p>Number of questions: {nQuestions}</p>\n            <p>Time: {(time / 60).toFixed(1)} mins</p>\n            {img}\n            {buttons}\n            {popupArea}\n          </li>\n        </ul>\n      </>\n    );\n  } else {\n    return null;\n  }\n}\n\nGameBoard.propTypes = {\n  quiz: propTypes.object,\n  changeAlert: propTypes.func,\n  forceLogout: propTypes.func\n};\n\nexport default GameBoard;\n"]},"metadata":{},"sourceType":"module"}