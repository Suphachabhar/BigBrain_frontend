{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n/**\r\n * Created by LzxHahaha on 2016/10/6.\r\n */\n\n\nvar STATUS = {\n  STOP: 'STOP',\n  START: 'START',\n  PAUSE: 'PAUSE',\n  OVER: 'OVER'\n};\nvar JUMP_DELTA = 5;\nvar JUMP_MAX_HEIGHT = 53;\n\nvar Game = function (_React$Component) {\n  _inherits(Game, _React$Component);\n\n  function Game(props) {\n    _classCallCheck(this, Game);\n\n    var _this = _possibleConstructorReturn(this, (Game.__proto__ || Object.getPrototypeOf(Game)).call(this, props));\n\n    _this.start = function () {\n      if (_this.status === STATUS.START) {\n        return;\n      }\n\n      _this.status = STATUS.START;\n\n      _this.__setTimer();\n\n      _this.jump();\n    };\n\n    _this.pause = function () {\n      if (_this.status === STATUS.START) {\n        _this.status = STATUS.PAUSE;\n\n        _this.__clearTimer();\n      }\n    };\n\n    _this.goOn = function () {\n      if (_this.status === STATUS.PAUSE) {\n        _this.status = STATUS.START;\n\n        _this.__setTimer();\n      }\n    };\n\n    _this.stop = function () {\n      if (_this.status === STATUS.OVER) {\n        return;\n      }\n\n      _this.status = STATUS.OVER;\n      _this.playerStatus = 3;\n\n      _this.__clearTimer();\n\n      _this.__draw();\n\n      _this.__clear();\n    };\n\n    _this.restart = function () {\n      _this.obstacles = _this.__obstaclesGenerate();\n\n      _this.start();\n    };\n\n    _this.jump = function () {\n      if (_this.jumpHeight > 2) {\n        return;\n      }\n\n      _this.jumpDelta = JUMP_DELTA;\n      _this.jumpHeight = JUMP_DELTA;\n    };\n\n    var imageLoadCount = 0;\n\n    var onImageLoaded = function onImageLoaded() {\n      ++imageLoadCount;\n\n      if (imageLoadCount === 3) {\n        _this.__draw();\n      }\n    }; // 资源文件\n\n\n    var skyImage = new Image();\n    var groundImage = new Image();\n    var playerImage = new Image();\n    var playerLeftImage = new Image();\n    var playerRightImage = new Image();\n    var playerDieImage = new Image();\n    var obstacleImage = new Image();\n    skyImage.onload = onImageLoaded;\n    groundImage.onload = onImageLoaded;\n    playerImage.onload = onImageLoaded;\n    skyImage.src = require('url-loader!./img/cloud.png');\n    groundImage.src = require('url-loader!./img/ground.png');\n    playerImage.src = require('url-loader!./img/dinosaur.png');\n    playerLeftImage.src = require('url-loader!./img/dinosaur_left.png');\n    playerRightImage.src = require('url-loader!./img/dinosaur_right.png');\n    playerDieImage.src = require('url-loader!./img/dinosaur_die.png');\n    obstacleImage.src = require('url-loader!./img/obstacle.png');\n    _this.options = _extends({\n      fps: 60,\n      skySpeed: 40,\n      groundSpeed: 100,\n      skyImage: skyImage,\n      groundImage: groundImage,\n      playerImage: [playerImage, playerLeftImage, playerRightImage, playerDieImage],\n      obstacleImage: obstacleImage,\n      skyOffset: 0,\n      groundOffset: 0\n    }, _this.props.options);\n    _this.status = STATUS.STOP;\n    _this.timer = null;\n    _this.score = 0;\n    _this.highScore = window.localStorage ? window.localStorage['highScore'] || 0 : 0;\n    _this.jumpHeight = 0;\n    _this.jumpDelta = 0;\n    _this.obstaclesBase = 1;\n    _this.obstacles = _this.__obstaclesGenerate();\n    _this.currentDistance = 0;\n    _this.playerStatus = 0;\n    return _this;\n  }\n\n  _createClass(Game, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (window.innerWidth >= 680) {\n        this.canvas.width = 680;\n      }\n\n      var onSpacePress = function onSpacePress() {\n        switch (_this2.status) {\n          case STATUS.STOP:\n            _this2.start();\n\n            break;\n\n          case STATUS.START:\n            _this2.jump();\n\n            break;\n\n          case STATUS.OVER:\n            _this2.restart();\n\n            break;\n        }\n      };\n\n      window.onkeypress = function (e) {\n        if (e.key === ' ') {\n          onSpacePress();\n        }\n      };\n\n      this.canvas.parentNode.onclick = onSpacePress;\n      window.onblur = this.pause;\n      window.onfocus = this.goOn;\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      window.onblur = null;\n      window.onfocus = null;\n    }\n  }, {\n    key: '__draw',\n    value: function __draw() {\n      if (!this.canvas) {\n        return;\n      }\n\n      var options = this.options;\n      var level = Math.min(200, Math.floor(this.score / 100));\n      var groundSpeed = (options.groundSpeed + level) / options.fps;\n      var skySpeed = options.skySpeed / options.fps;\n      var obstacleWidth = options.obstacleImage.width;\n      var playerWidth = options.playerImage[0].width;\n      var playerHeight = options.playerImage[0].height;\n      var ctx = this.canvas.getContext('2d');\n      var _canvas = this.canvas;\n      var width = _canvas.width;\n      var height = _canvas.height;\n      ctx.clearRect(0, 0, width, height);\n      ctx.save(); // 云\n\n      this.options.skyOffset = this.options.skyOffset < width ? this.options.skyOffset + skySpeed : this.options.skyOffset - width;\n      ctx.translate(-this.options.skyOffset, 0);\n      ctx.drawImage(this.options.skyImage, 0, 0);\n      ctx.drawImage(this.options.skyImage, this.options.skyImage.width, 0); // 地面\n\n      this.options.groundOffset = this.options.groundOffset < width ? this.options.groundOffset + groundSpeed : this.options.groundOffset - width;\n      ctx.translate(this.options.skyOffset - this.options.groundOffset, 0);\n      ctx.drawImage(this.options.groundImage, 0, 76);\n      ctx.drawImage(this.options.groundImage, this.options.groundImage.width, 76); // 恐龙\n      // 这里已经将坐标还原回左上角\n\n      ctx.translate(this.options.groundOffset, 0);\n      ctx.drawImage(this.options.playerImage[this.playerStatus], 80, 64 - this.jumpHeight); // 更新跳跃高度/速度\n\n      this.jumpHeight = this.jumpHeight + this.jumpDelta;\n\n      if (this.jumpHeight <= 1) {\n        this.jumpHeight = 0;\n        this.jumpDelta = 0;\n      } else if (this.jumpHeight < JUMP_MAX_HEIGHT && this.jumpDelta > 0) {\n        this.jumpDelta = this.jumpHeight * this.jumpHeight * 0.001033 - this.jumpHeight * 0.137 + 5;\n      } else if (this.jumpHeight < JUMP_MAX_HEIGHT && this.jumpDelta < 0) {// jumpDelta = (jumpHeight * jumpHeight) * 0.00023 - jumpHeight * 0.03 - 4;\n      } else if (this.jumpHeight >= JUMP_MAX_HEIGHT) {\n        this.jumpDelta = -JUMP_DELTA / 2.7;\n      } // 分数\n\n\n      var scoreText = (this.status === STATUS.OVER ? 'GAME OVER  ' : '') + Math.floor(this.score);\n      ctx.font = \"Bold 18px Arial\";\n      ctx.textAlign = \"right\";\n      ctx.fillStyle = \"#595959\";\n      ctx.fillText(scoreText, width - 30, 23);\n\n      if (this.status === STATUS.START) {\n        this.score += 0.5;\n\n        if (this.score > this.highScore) {\n          this.highScore = this.score;\n          window.localStorage['highScore'] = this.score;\n        }\n\n        this.currentDistance += groundSpeed;\n\n        if (this.score % 4 === 0) {\n          this.playerStatus = (this.playerStatus + 1) % 3;\n        }\n      }\n\n      if (this.highScore) {\n        ctx.textAlign = \"left\";\n        ctx.fillText('HIGH  ' + Math.floor(this.highScore), 30, 23);\n      } // 障碍\n\n\n      var pop = 0;\n\n      for (var i = 0; i < this.obstacles.length; ++i) {\n        if (this.currentDistance >= this.obstacles[i].distance) {\n          var offset = width - (this.currentDistance - this.obstacles[i].distance + groundSpeed);\n\n          if (offset > 0) {\n            ctx.drawImage(options.obstacleImage, offset, 84);\n          } else {\n            ++pop;\n          }\n        } else {\n          break;\n        }\n      }\n\n      for (var _i = 0; _i < pop; ++_i) {\n        this.obstacles.shift();\n      }\n\n      if (this.obstacles.length < 5) {\n        this.obstacles = this.obstacles.concat(this.__obstaclesGenerate());\n      } // 碰撞检测\n\n\n      var firstOffset = width - (this.currentDistance - this.obstacles[0].distance + groundSpeed);\n\n      if (90 - obstacleWidth < firstOffset && firstOffset < 60 + playerWidth && 64 - this.jumpHeight + playerHeight > 84) {\n        this.stop();\n      }\n\n      ctx.restore();\n    }\n  }, {\n    key: '__obstaclesGenerate',\n    value: function __obstaclesGenerate() {\n      var res = [];\n\n      for (var i = 0; i < 10; ++i) {\n        var random = Math.floor(Math.random() * 100) % 60;\n        random = (Math.random() * 10 % 2 === 0 ? 1 : -1) * random;\n        res.push({\n          distance: random + this.obstaclesBase * 200\n        });\n        ++this.obstaclesBase;\n      }\n\n      return res;\n    }\n  }, {\n    key: '__setTimer',\n    value: function __setTimer() {\n      var _this3 = this;\n\n      this.timer = setInterval(function () {\n        return _this3.__draw();\n      }, 1000 / this.options.fps);\n    }\n  }, {\n    key: '__clearTimer',\n    value: function __clearTimer() {\n      if (this.timer) {\n        clearInterval(this.timer);\n        this.timer = null;\n      }\n    }\n  }, {\n    key: '__clear',\n    value: function __clear() {\n      this.score = 0;\n      this.jumpHeight = 0;\n      this.currentDistance = 0;\n      this.obstacles = [];\n      this.obstaclesBase = 1;\n      this.playerStatus = 0;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      return _react2.default.createElement('canvas', {\n        id: 'canvas',\n        ref: function ref(_ref) {\n          return _this4.canvas = _ref;\n        },\n        height: 160,\n        width: 340\n      });\n    }\n  }]);\n\n  return Game;\n}(_react2.default.Component);\n\nexports.default = Game;\n;","map":{"version":3,"sources":["/Users/suphachabharnigrodhananda/Desktop/6080/ass3/node_modules/react-dinosaur-game/dist/Game.js"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react","require","_react2","_interopRequireDefault","obj","__esModule","default","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","STATUS","STOP","START","PAUSE","OVER","JUMP_DELTA","JUMP_MAX_HEIGHT","Game","_React$Component","_this","getPrototypeOf","start","status","__setTimer","jump","pause","__clearTimer","goOn","stop","playerStatus","__draw","__clear","restart","obstacles","__obstaclesGenerate","jumpHeight","jumpDelta","imageLoadCount","onImageLoaded","skyImage","Image","groundImage","playerImage","playerLeftImage","playerRightImage","playerDieImage","obstacleImage","onload","src","options","fps","skySpeed","groundSpeed","skyOffset","groundOffset","timer","score","highScore","window","localStorage","obstaclesBase","currentDistance","componentDidMount","_this2","innerWidth","canvas","width","onSpacePress","onkeypress","e","parentNode","onclick","onblur","onfocus","componentWillUnmount","level","Math","min","floor","obstacleWidth","playerWidth","playerHeight","height","ctx","getContext","_canvas","clearRect","save","translate","drawImage","scoreText","font","textAlign","fillStyle","fillText","pop","distance","offset","_i","shift","concat","firstOffset","restore","res","random","push","_this3","setInterval","clearInterval","render","_this4","createElement","id","ref","_ref","Component"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;;AAIA,IAAIC,QAAQ,GAAGJ,MAAM,CAACK,MAAP,IAAiB,UAAUC,MAAV,EAAkB;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAtB;;AAA2B,SAAK,IAAII,GAAT,IAAgBD,MAAhB,EAAwB;AAAE,UAAIV,MAAM,CAACY,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,MAArC,EAA6CC,GAA7C,CAAJ,EAAuD;AAAEL,QAAAA,MAAM,CAACK,GAAD,CAAN,GAAcD,MAAM,CAACC,GAAD,CAApB;AAA4B;AAAE;AAAE;;AAAC,SAAOL,MAAP;AAAgB,CAAhQ;;AAEA,IAAIS,YAAY,GAAG,YAAY;AAAE,WAASC,gBAAT,CAA0BV,MAA1B,EAAkCW,KAAlC,EAAyC;AAAE,SAAK,IAAIV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,KAAK,CAACR,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AAAE,UAAIW,UAAU,GAAGD,KAAK,CAACV,CAAD,CAAtB;AAA2BW,MAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AAAwDD,MAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AAAgC,UAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAA4BrB,MAAAA,MAAM,CAACC,cAAP,CAAsBK,MAAtB,EAA8BY,UAAU,CAACP,GAAzC,EAA8CO,UAA9C;AAA4D;AAAE;;AAAC,SAAO,UAAUI,WAAV,EAAuBC,UAAvB,EAAmCC,WAAnC,EAAgD;AAAE,QAAID,UAAJ,EAAgBP,gBAAgB,CAACM,WAAW,CAACV,SAAb,EAAwBW,UAAxB,CAAhB;AAAqD,QAAIC,WAAJ,EAAiBR,gBAAgB,CAACM,WAAD,EAAcE,WAAd,CAAhB;AAA4C,WAAOF,WAAP;AAAqB,GAAhN;AAAmN,CAA9hB,EAAnB;;AAEA,IAAIG,MAAM,GAAGC,OAAO,CAAC,OAAD,CAApB;;AAEA,IAAIC,OAAO,GAAGC,sBAAsB,CAACH,MAAD,CAApC;;AAEA,SAASG,sBAAT,CAAgCC,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACC,UAAX,GAAwBD,GAAxB,GAA8B;AAAEE,IAAAA,OAAO,EAAEF;AAAX,GAArC;AAAwD;;AAE/F,SAASG,eAAT,CAAyBC,QAAzB,EAAmCX,WAAnC,EAAgD;AAAE,MAAI,EAAEW,QAAQ,YAAYX,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIY,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASC,0BAAT,CAAoCC,IAApC,EAA0CtB,IAA1C,EAAgD;AAAE,MAAI,CAACsB,IAAL,EAAW;AAAE,UAAM,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOvB,IAAI,KAAK,OAAOA,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAAjD,CAAJ,GAAmEA,IAAnE,GAA0EsB,IAAjF;AAAwF;;AAEhP,SAASE,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AAAE,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAAE,UAAM,IAAIN,SAAJ,CAAc,6DAA6D,OAAOM,UAAlF,CAAN;AAAsG;;AAACD,EAAAA,QAAQ,CAAC3B,SAAT,GAAqBZ,MAAM,CAACyC,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAAC5B,SAAvC,EAAkD;AAAE8B,IAAAA,WAAW,EAAE;AAAEvC,MAAAA,KAAK,EAAEoC,QAAT;AAAmBpB,MAAAA,UAAU,EAAE,KAA/B;AAAsCE,MAAAA,QAAQ,EAAE,IAAhD;AAAsDD,MAAAA,YAAY,EAAE;AAApE;AAAf,GAAlD,CAArB;AAAqK,MAAIoB,UAAJ,EAAgBxC,MAAM,CAAC2C,cAAP,GAAwB3C,MAAM,CAAC2C,cAAP,CAAsBJ,QAAtB,EAAgCC,UAAhC,CAAxB,GAAsED,QAAQ,CAACK,SAAT,GAAqBJ,UAA3F;AAAwG;AAAC;AAC/e;AACA;;;AAEA,IAAIK,MAAM,GAAG;AACXC,EAAAA,IAAI,EAAE,MADK;AAEXC,EAAAA,KAAK,EAAE,OAFI;AAGXC,EAAAA,KAAK,EAAE,OAHI;AAIXC,EAAAA,IAAI,EAAE;AAJK,CAAb;AAOA,IAAIC,UAAU,GAAG,CAAjB;AACA,IAAIC,eAAe,GAAG,EAAtB;;AAEA,IAAIC,IAAI,GAAG,UAAUC,gBAAV,EAA4B;AACrCf,EAAAA,SAAS,CAACc,IAAD,EAAOC,gBAAP,CAAT;;AAEA,WAASD,IAAT,CAAcnC,KAAd,EAAqB;AACnBe,IAAAA,eAAe,CAAC,IAAD,EAAOoB,IAAP,CAAf;;AAEA,QAAIE,KAAK,GAAGnB,0BAA0B,CAAC,IAAD,EAAO,CAACiB,IAAI,CAACR,SAAL,IAAkB5C,MAAM,CAACuD,cAAP,CAAsBH,IAAtB,CAAnB,EAAgDtC,IAAhD,CAAqD,IAArD,EAA2DG,KAA3D,CAAP,CAAtC;;AAEAqC,IAAAA,KAAK,CAACE,KAAN,GAAc,YAAY;AACxB,UAAIF,KAAK,CAACG,MAAN,KAAiBZ,MAAM,CAACE,KAA5B,EAAmC;AACjC;AACD;;AAEDO,MAAAA,KAAK,CAACG,MAAN,GAAeZ,MAAM,CAACE,KAAtB;;AACAO,MAAAA,KAAK,CAACI,UAAN;;AACAJ,MAAAA,KAAK,CAACK,IAAN;AACD,KARD;;AAUAL,IAAAA,KAAK,CAACM,KAAN,GAAc,YAAY;AACxB,UAAIN,KAAK,CAACG,MAAN,KAAiBZ,MAAM,CAACE,KAA5B,EAAmC;AACjCO,QAAAA,KAAK,CAACG,MAAN,GAAeZ,MAAM,CAACG,KAAtB;;AACAM,QAAAA,KAAK,CAACO,YAAN;AACD;AACF,KALD;;AAOAP,IAAAA,KAAK,CAACQ,IAAN,GAAa,YAAY;AACvB,UAAIR,KAAK,CAACG,MAAN,KAAiBZ,MAAM,CAACG,KAA5B,EAAmC;AACjCM,QAAAA,KAAK,CAACG,MAAN,GAAeZ,MAAM,CAACE,KAAtB;;AACAO,QAAAA,KAAK,CAACI,UAAN;AACD;AACF,KALD;;AAOAJ,IAAAA,KAAK,CAACS,IAAN,GAAa,YAAY;AACvB,UAAIT,KAAK,CAACG,MAAN,KAAiBZ,MAAM,CAACI,IAA5B,EAAkC;AAChC;AACD;;AACDK,MAAAA,KAAK,CAACG,MAAN,GAAeZ,MAAM,CAACI,IAAtB;AACAK,MAAAA,KAAK,CAACU,YAAN,GAAqB,CAArB;;AACAV,MAAAA,KAAK,CAACO,YAAN;;AACAP,MAAAA,KAAK,CAACW,MAAN;;AACAX,MAAAA,KAAK,CAACY,OAAN;AACD,KATD;;AAWAZ,IAAAA,KAAK,CAACa,OAAN,GAAgB,YAAY;AAC1Bb,MAAAA,KAAK,CAACc,SAAN,GAAkBd,KAAK,CAACe,mBAAN,EAAlB;;AACAf,MAAAA,KAAK,CAACE,KAAN;AACD,KAHD;;AAKAF,IAAAA,KAAK,CAACK,IAAN,GAAa,YAAY;AACvB,UAAIL,KAAK,CAACgB,UAAN,GAAmB,CAAvB,EAA0B;AACxB;AACD;;AACDhB,MAAAA,KAAK,CAACiB,SAAN,GAAkBrB,UAAlB;AACAI,MAAAA,KAAK,CAACgB,UAAN,GAAmBpB,UAAnB;AACD,KAND;;AAQA,QAAIsB,cAAc,GAAG,CAArB;;AACA,QAAIC,aAAa,GAAG,SAASA,aAAT,GAAyB;AAC3C,QAAED,cAAF;;AACA,UAAIA,cAAc,KAAK,CAAvB,EAA0B;AACxBlB,QAAAA,KAAK,CAACW,MAAN;AACD;AACF,KALD,CAtDmB,CA6DnB;;;AACA,QAAIS,QAAQ,GAAG,IAAIC,KAAJ,EAAf;AACA,QAAIC,WAAW,GAAG,IAAID,KAAJ,EAAlB;AACA,QAAIE,WAAW,GAAG,IAAIF,KAAJ,EAAlB;AACA,QAAIG,eAAe,GAAG,IAAIH,KAAJ,EAAtB;AACA,QAAII,gBAAgB,GAAG,IAAIJ,KAAJ,EAAvB;AACA,QAAIK,cAAc,GAAG,IAAIL,KAAJ,EAArB;AACA,QAAIM,aAAa,GAAG,IAAIN,KAAJ,EAApB;AAEAD,IAAAA,QAAQ,CAACQ,MAAT,GAAkBT,aAAlB;AACAG,IAAAA,WAAW,CAACM,MAAZ,GAAqBT,aAArB;AACAI,IAAAA,WAAW,CAACK,MAAZ,GAAqBT,aAArB;AAEAC,IAAAA,QAAQ,CAACS,GAAT,GAAezD,OAAO,CAAC,4BAAD,CAAtB;AACAkD,IAAAA,WAAW,CAACO,GAAZ,GAAkBzD,OAAO,CAAC,6BAAD,CAAzB;AACAmD,IAAAA,WAAW,CAACM,GAAZ,GAAkBzD,OAAO,CAAC,+BAAD,CAAzB;AACAoD,IAAAA,eAAe,CAACK,GAAhB,GAAsBzD,OAAO,CAAC,oCAAD,CAA7B;AACAqD,IAAAA,gBAAgB,CAACI,GAAjB,GAAuBzD,OAAO,CAAC,qCAAD,CAA9B;AACAsD,IAAAA,cAAc,CAACG,GAAf,GAAqBzD,OAAO,CAAC,mCAAD,CAA5B;AACAuD,IAAAA,aAAa,CAACE,GAAd,GAAoBzD,OAAO,CAAC,+BAAD,CAA3B;AAEA4B,IAAAA,KAAK,CAAC8B,OAAN,GAAgBhF,QAAQ,CAAC;AACvBiF,MAAAA,GAAG,EAAE,EADkB;AAEvBC,MAAAA,QAAQ,EAAE,EAFa;AAGvBC,MAAAA,WAAW,EAAE,GAHU;AAIvBb,MAAAA,QAAQ,EAAEA,QAJa;AAKvBE,MAAAA,WAAW,EAAEA,WALU;AAMvBC,MAAAA,WAAW,EAAE,CAACA,WAAD,EAAcC,eAAd,EAA+BC,gBAA/B,EAAiDC,cAAjD,CANU;AAOvBC,MAAAA,aAAa,EAAEA,aAPQ;AAQvBO,MAAAA,SAAS,EAAE,CARY;AASvBC,MAAAA,YAAY,EAAE;AATS,KAAD,EAUrBnC,KAAK,CAACrC,KAAN,CAAYmE,OAVS,CAAxB;AAYA9B,IAAAA,KAAK,CAACG,MAAN,GAAeZ,MAAM,CAACC,IAAtB;AACAQ,IAAAA,KAAK,CAACoC,KAAN,GAAc,IAAd;AACApC,IAAAA,KAAK,CAACqC,KAAN,GAAc,CAAd;AACArC,IAAAA,KAAK,CAACsC,SAAN,GAAkBC,MAAM,CAACC,YAAP,GAAsBD,MAAM,CAACC,YAAP,CAAoB,WAApB,KAAoC,CAA1D,GAA8D,CAAhF;AACAxC,IAAAA,KAAK,CAACgB,UAAN,GAAmB,CAAnB;AACAhB,IAAAA,KAAK,CAACiB,SAAN,GAAkB,CAAlB;AACAjB,IAAAA,KAAK,CAACyC,aAAN,GAAsB,CAAtB;AACAzC,IAAAA,KAAK,CAACc,SAAN,GAAkBd,KAAK,CAACe,mBAAN,EAAlB;AACAf,IAAAA,KAAK,CAAC0C,eAAN,GAAwB,CAAxB;AACA1C,IAAAA,KAAK,CAACU,YAAN,GAAqB,CAArB;AACA,WAAOV,KAAP;AACD;;AAEDvC,EAAAA,YAAY,CAACqC,IAAD,EAAO,CAAC;AAClBzC,IAAAA,GAAG,EAAE,mBADa;AAElBR,IAAAA,KAAK,EAAE,SAAS8F,iBAAT,GAA6B;AAClC,UAAIC,MAAM,GAAG,IAAb;;AAEA,UAAIL,MAAM,CAACM,UAAP,IAAqB,GAAzB,EAA8B;AAC5B,aAAKC,MAAL,CAAYC,KAAZ,GAAoB,GAApB;AACD;;AAED,UAAIC,YAAY,GAAG,SAASA,YAAT,GAAwB;AACzC,gBAAQJ,MAAM,CAACzC,MAAf;AACE,eAAKZ,MAAM,CAACC,IAAZ;AACEoD,YAAAA,MAAM,CAAC1C,KAAP;;AACA;;AACF,eAAKX,MAAM,CAACE,KAAZ;AACEmD,YAAAA,MAAM,CAACvC,IAAP;;AACA;;AACF,eAAKd,MAAM,CAACI,IAAZ;AACEiD,YAAAA,MAAM,CAAC/B,OAAP;;AACA;AATJ;AAWD,OAZD;;AAcA0B,MAAAA,MAAM,CAACU,UAAP,GAAoB,UAAUC,CAAV,EAAa;AAC/B,YAAIA,CAAC,CAAC7F,GAAF,KAAU,GAAd,EAAmB;AACjB2F,UAAAA,YAAY;AACb;AACF,OAJD;;AAKA,WAAKF,MAAL,CAAYK,UAAZ,CAAuBC,OAAvB,GAAiCJ,YAAjC;AAEAT,MAAAA,MAAM,CAACc,MAAP,GAAgB,KAAK/C,KAArB;AACAiC,MAAAA,MAAM,CAACe,OAAP,GAAiB,KAAK9C,IAAtB;AACD;AAhCiB,GAAD,EAiChB;AACDnD,IAAAA,GAAG,EAAE,sBADJ;AAEDR,IAAAA,KAAK,EAAE,SAAS0G,oBAAT,GAAgC;AACrChB,MAAAA,MAAM,CAACc,MAAP,GAAgB,IAAhB;AACAd,MAAAA,MAAM,CAACe,OAAP,GAAiB,IAAjB;AACD;AALA,GAjCgB,EAuChB;AACDjG,IAAAA,GAAG,EAAE,QADJ;AAEDR,IAAAA,KAAK,EAAE,SAAS8D,MAAT,GAAkB;AACvB,UAAI,CAAC,KAAKmC,MAAV,EAAkB;AAChB;AACD;;AAED,UAAIhB,OAAO,GAAG,KAAKA,OAAnB;AAGA,UAAI0B,KAAK,GAAGC,IAAI,CAACC,GAAL,CAAS,GAAT,EAAcD,IAAI,CAACE,KAAL,CAAW,KAAKtB,KAAL,GAAa,GAAxB,CAAd,CAAZ;AACA,UAAIJ,WAAW,GAAG,CAACH,OAAO,CAACG,WAAR,GAAsBuB,KAAvB,IAAgC1B,OAAO,CAACC,GAA1D;AACA,UAAIC,QAAQ,GAAGF,OAAO,CAACE,QAAR,GAAmBF,OAAO,CAACC,GAA1C;AACA,UAAI6B,aAAa,GAAG9B,OAAO,CAACH,aAAR,CAAsBoB,KAA1C;AACA,UAAIc,WAAW,GAAG/B,OAAO,CAACP,WAAR,CAAoB,CAApB,EAAuBwB,KAAzC;AACA,UAAIe,YAAY,GAAGhC,OAAO,CAACP,WAAR,CAAoB,CAApB,EAAuBwC,MAA1C;AAEA,UAAIC,GAAG,GAAG,KAAKlB,MAAL,CAAYmB,UAAZ,CAAuB,IAAvB,CAAV;AACA,UAAIC,OAAO,GAAG,KAAKpB,MAAnB;AACA,UAAIC,KAAK,GAAGmB,OAAO,CAACnB,KAApB;AACA,UAAIgB,MAAM,GAAGG,OAAO,CAACH,MAArB;AAGAC,MAAAA,GAAG,CAACG,SAAJ,CAAc,CAAd,EAAiB,CAAjB,EAAoBpB,KAApB,EAA2BgB,MAA3B;AACAC,MAAAA,GAAG,CAACI,IAAJ,GAtBuB,CAwBvB;;AACA,WAAKtC,OAAL,CAAaI,SAAb,GAAyB,KAAKJ,OAAL,CAAaI,SAAb,GAAyBa,KAAzB,GAAiC,KAAKjB,OAAL,CAAaI,SAAb,GAAyBF,QAA1D,GAAqE,KAAKF,OAAL,CAAaI,SAAb,GAAyBa,KAAvH;AACAiB,MAAAA,GAAG,CAACK,SAAJ,CAAc,CAAC,KAAKvC,OAAL,CAAaI,SAA5B,EAAuC,CAAvC;AACA8B,MAAAA,GAAG,CAACM,SAAJ,CAAc,KAAKxC,OAAL,CAAaV,QAA3B,EAAqC,CAArC,EAAwC,CAAxC;AACA4C,MAAAA,GAAG,CAACM,SAAJ,CAAc,KAAKxC,OAAL,CAAaV,QAA3B,EAAqC,KAAKU,OAAL,CAAaV,QAAb,CAAsB2B,KAA3D,EAAkE,CAAlE,EA5BuB,CA8BvB;;AACA,WAAKjB,OAAL,CAAaK,YAAb,GAA4B,KAAKL,OAAL,CAAaK,YAAb,GAA4BY,KAA5B,GAAoC,KAAKjB,OAAL,CAAaK,YAAb,GAA4BF,WAAhE,GAA8E,KAAKH,OAAL,CAAaK,YAAb,GAA4BY,KAAtI;AACAiB,MAAAA,GAAG,CAACK,SAAJ,CAAc,KAAKvC,OAAL,CAAaI,SAAb,GAAyB,KAAKJ,OAAL,CAAaK,YAApD,EAAkE,CAAlE;AACA6B,MAAAA,GAAG,CAACM,SAAJ,CAAc,KAAKxC,OAAL,CAAaR,WAA3B,EAAwC,CAAxC,EAA2C,EAA3C;AACA0C,MAAAA,GAAG,CAACM,SAAJ,CAAc,KAAKxC,OAAL,CAAaR,WAA3B,EAAwC,KAAKQ,OAAL,CAAaR,WAAb,CAAyByB,KAAjE,EAAwE,EAAxE,EAlCuB,CAoCvB;AACA;;AACAiB,MAAAA,GAAG,CAACK,SAAJ,CAAc,KAAKvC,OAAL,CAAaK,YAA3B,EAAyC,CAAzC;AACA6B,MAAAA,GAAG,CAACM,SAAJ,CAAc,KAAKxC,OAAL,CAAaP,WAAb,CAAyB,KAAKb,YAA9B,CAAd,EAA2D,EAA3D,EAA+D,KAAK,KAAKM,UAAzE,EAvCuB,CAwCvB;;AACA,WAAKA,UAAL,GAAkB,KAAKA,UAAL,GAAkB,KAAKC,SAAzC;;AACA,UAAI,KAAKD,UAAL,IAAmB,CAAvB,EAA0B;AACxB,aAAKA,UAAL,GAAkB,CAAlB;AACA,aAAKC,SAAL,GAAiB,CAAjB;AACD,OAHD,MAGO,IAAI,KAAKD,UAAL,GAAkBnB,eAAlB,IAAqC,KAAKoB,SAAL,GAAiB,CAA1D,EAA6D;AAClE,aAAKA,SAAL,GAAiB,KAAKD,UAAL,GAAkB,KAAKA,UAAvB,GAAoC,QAApC,GAA+C,KAAKA,UAAL,GAAkB,KAAjE,GAAyE,CAA1F;AACD,OAFM,MAEA,IAAI,KAAKA,UAAL,GAAkBnB,eAAlB,IAAqC,KAAKoB,SAAL,GAAiB,CAA1D,EAA6D,CAClE;AACD,OAFM,MAEA,IAAI,KAAKD,UAAL,IAAmBnB,eAAvB,EAAwC;AAC7C,aAAKoB,SAAL,GAAiB,CAACrB,UAAD,GAAc,GAA/B;AACD,OAnDsB,CAqDvB;;;AACA,UAAI2E,SAAS,GAAG,CAAC,KAAKpE,MAAL,KAAgBZ,MAAM,CAACI,IAAvB,GAA8B,aAA9B,GAA8C,EAA/C,IAAqD8D,IAAI,CAACE,KAAL,CAAW,KAAKtB,KAAhB,CAArE;AACA2B,MAAAA,GAAG,CAACQ,IAAJ,GAAW,iBAAX;AACAR,MAAAA,GAAG,CAACS,SAAJ,GAAgB,OAAhB;AACAT,MAAAA,GAAG,CAACU,SAAJ,GAAgB,SAAhB;AACAV,MAAAA,GAAG,CAACW,QAAJ,CAAaJ,SAAb,EAAwBxB,KAAK,GAAG,EAAhC,EAAoC,EAApC;;AACA,UAAI,KAAK5C,MAAL,KAAgBZ,MAAM,CAACE,KAA3B,EAAkC;AAChC,aAAK4C,KAAL,IAAc,GAAd;;AACA,YAAI,KAAKA,KAAL,GAAa,KAAKC,SAAtB,EAAiC;AAC/B,eAAKA,SAAL,GAAiB,KAAKD,KAAtB;AACAE,UAAAA,MAAM,CAACC,YAAP,CAAoB,WAApB,IAAmC,KAAKH,KAAxC;AACD;;AACD,aAAKK,eAAL,IAAwBT,WAAxB;;AACA,YAAI,KAAKI,KAAL,GAAa,CAAb,KAAmB,CAAvB,EAA0B;AACxB,eAAK3B,YAAL,GAAoB,CAAC,KAAKA,YAAL,GAAoB,CAArB,IAA0B,CAA9C;AACD;AACF;;AACD,UAAI,KAAK4B,SAAT,EAAoB;AAClB0B,QAAAA,GAAG,CAACS,SAAJ,GAAgB,MAAhB;AACAT,QAAAA,GAAG,CAACW,QAAJ,CAAa,WAAWlB,IAAI,CAACE,KAAL,CAAW,KAAKrB,SAAhB,CAAxB,EAAoD,EAApD,EAAwD,EAAxD;AACD,OAzEsB,CA2EvB;;;AACA,UAAIsC,GAAG,GAAG,CAAV;;AACA,WAAK,IAAI3H,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK6D,SAAL,CAAe3D,MAAnC,EAA2C,EAAEF,CAA7C,EAAgD;AAC9C,YAAI,KAAKyF,eAAL,IAAwB,KAAK5B,SAAL,CAAe7D,CAAf,EAAkB4H,QAA9C,EAAwD;AACtD,cAAIC,MAAM,GAAG/B,KAAK,IAAI,KAAKL,eAAL,GAAuB,KAAK5B,SAAL,CAAe7D,CAAf,EAAkB4H,QAAzC,GAAoD5C,WAAxD,CAAlB;;AACA,cAAI6C,MAAM,GAAG,CAAb,EAAgB;AACdd,YAAAA,GAAG,CAACM,SAAJ,CAAcxC,OAAO,CAACH,aAAtB,EAAqCmD,MAArC,EAA6C,EAA7C;AACD,WAFD,MAEO;AACL,cAAEF,GAAF;AACD;AACF,SAPD,MAOO;AACL;AACD;AACF;;AACD,WAAK,IAAIG,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGH,GAAtB,EAA2B,EAAEG,EAA7B,EAAiC;AAC/B,aAAKjE,SAAL,CAAekE,KAAf;AACD;;AACD,UAAI,KAAKlE,SAAL,CAAe3D,MAAf,GAAwB,CAA5B,EAA+B;AAC7B,aAAK2D,SAAL,GAAiB,KAAKA,SAAL,CAAemE,MAAf,CAAsB,KAAKlE,mBAAL,EAAtB,CAAjB;AACD,OA9FsB,CAgGvB;;;AACA,UAAImE,WAAW,GAAGnC,KAAK,IAAI,KAAKL,eAAL,GAAuB,KAAK5B,SAAL,CAAe,CAAf,EAAkB+D,QAAzC,GAAoD5C,WAAxD,CAAvB;;AACA,UAAI,KAAK2B,aAAL,GAAqBsB,WAArB,IAAoCA,WAAW,GAAG,KAAKrB,WAAvD,IAAsE,KAAK,KAAK7C,UAAV,GAAuB8C,YAAvB,GAAsC,EAAhH,EAAoH;AAClH,aAAKrD,IAAL;AACD;;AAEDuD,MAAAA,GAAG,CAACmB,OAAJ;AACD;AAzGA,GAvCgB,EAiJhB;AACD9H,IAAAA,GAAG,EAAE,qBADJ;AAEDR,IAAAA,KAAK,EAAE,SAASkE,mBAAT,GAA+B;AACpC,UAAIqE,GAAG,GAAG,EAAV;;AACA,WAAK,IAAInI,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwB,EAAEA,CAA1B,EAA6B;AAC3B,YAAIoI,MAAM,GAAG5B,IAAI,CAACE,KAAL,CAAWF,IAAI,CAAC4B,MAAL,KAAgB,GAA3B,IAAkC,EAA/C;AACAA,QAAAA,MAAM,GAAG,CAAC5B,IAAI,CAAC4B,MAAL,KAAgB,EAAhB,GAAqB,CAArB,KAA2B,CAA3B,GAA+B,CAA/B,GAAmC,CAAC,CAArC,IAA0CA,MAAnD;AACAD,QAAAA,GAAG,CAACE,IAAJ,CAAS;AACPT,UAAAA,QAAQ,EAAEQ,MAAM,GAAG,KAAK5C,aAAL,GAAqB;AADjC,SAAT;AAGA,UAAE,KAAKA,aAAP;AACD;;AACD,aAAO2C,GAAP;AACD;AAbA,GAjJgB,EA+JhB;AACD/H,IAAAA,GAAG,EAAE,YADJ;AAEDR,IAAAA,KAAK,EAAE,SAASuD,UAAT,GAAsB;AAC3B,UAAImF,MAAM,GAAG,IAAb;;AAEA,WAAKnD,KAAL,GAAaoD,WAAW,CAAC,YAAY;AACnC,eAAOD,MAAM,CAAC5E,MAAP,EAAP;AACD,OAFuB,EAErB,OAAO,KAAKmB,OAAL,CAAaC,GAFC,CAAxB;AAGD;AARA,GA/JgB,EAwKhB;AACD1E,IAAAA,GAAG,EAAE,cADJ;AAEDR,IAAAA,KAAK,EAAE,SAAS0D,YAAT,GAAwB;AAC7B,UAAI,KAAK6B,KAAT,EAAgB;AACdqD,QAAAA,aAAa,CAAC,KAAKrD,KAAN,CAAb;AACA,aAAKA,KAAL,GAAa,IAAb;AACD;AACF;AAPA,GAxKgB,EAgLhB;AACD/E,IAAAA,GAAG,EAAE,SADJ;AAEDR,IAAAA,KAAK,EAAE,SAAS+D,OAAT,GAAmB;AACxB,WAAKyB,KAAL,GAAa,CAAb;AACA,WAAKrB,UAAL,GAAkB,CAAlB;AACA,WAAK0B,eAAL,GAAuB,CAAvB;AACA,WAAK5B,SAAL,GAAiB,EAAjB;AACA,WAAK2B,aAAL,GAAqB,CAArB;AACA,WAAK/B,YAAL,GAAoB,CAApB;AACD;AATA,GAhLgB,EA0LhB;AACDrD,IAAAA,GAAG,EAAE,QADJ;AAEDR,IAAAA,KAAK,EAAE,SAAS6I,MAAT,GAAkB;AACvB,UAAIC,MAAM,GAAG,IAAb;;AAEA,aAAOtH,OAAO,CAACI,OAAR,CAAgBmH,aAAhB,CAA8B,QAA9B,EAAwC;AAAEC,QAAAA,EAAE,EAAE,QAAN;AAAgBC,QAAAA,GAAG,EAAE,SAASA,GAAT,CAAaC,IAAb,EAAmB;AACnF,iBAAOJ,MAAM,CAAC7C,MAAP,GAAgBiD,IAAvB;AACD,SAF4C;AAE1ChC,QAAAA,MAAM,EAAE,GAFkC;AAE7BhB,QAAAA,KAAK,EAAE;AAFsB,OAAxC,CAAP;AAGD;AARA,GA1LgB,CAAP,CAAZ;;AAqMA,SAAOjD,IAAP;AACD,CApTU,CAoTTzB,OAAO,CAACI,OAAR,CAAgBuH,SApTP,CAAX;;AAsTApJ,OAAO,CAAC6B,OAAR,GAAkBqB,IAAlB;AACA","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Created by LzxHahaha on 2016/10/6.\r\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar STATUS = {\n  STOP: 'STOP',\n  START: 'START',\n  PAUSE: 'PAUSE',\n  OVER: 'OVER'\n};\n\nvar JUMP_DELTA = 5;\nvar JUMP_MAX_HEIGHT = 53;\n\nvar Game = function (_React$Component) {\n  _inherits(Game, _React$Component);\n\n  function Game(props) {\n    _classCallCheck(this, Game);\n\n    var _this = _possibleConstructorReturn(this, (Game.__proto__ || Object.getPrototypeOf(Game)).call(this, props));\n\n    _this.start = function () {\n      if (_this.status === STATUS.START) {\n        return;\n      }\n\n      _this.status = STATUS.START;\n      _this.__setTimer();\n      _this.jump();\n    };\n\n    _this.pause = function () {\n      if (_this.status === STATUS.START) {\n        _this.status = STATUS.PAUSE;\n        _this.__clearTimer();\n      }\n    };\n\n    _this.goOn = function () {\n      if (_this.status === STATUS.PAUSE) {\n        _this.status = STATUS.START;\n        _this.__setTimer();\n      }\n    };\n\n    _this.stop = function () {\n      if (_this.status === STATUS.OVER) {\n        return;\n      }\n      _this.status = STATUS.OVER;\n      _this.playerStatus = 3;\n      _this.__clearTimer();\n      _this.__draw();\n      _this.__clear();\n    };\n\n    _this.restart = function () {\n      _this.obstacles = _this.__obstaclesGenerate();\n      _this.start();\n    };\n\n    _this.jump = function () {\n      if (_this.jumpHeight > 2) {\n        return;\n      }\n      _this.jumpDelta = JUMP_DELTA;\n      _this.jumpHeight = JUMP_DELTA;\n    };\n\n    var imageLoadCount = 0;\n    var onImageLoaded = function onImageLoaded() {\n      ++imageLoadCount;\n      if (imageLoadCount === 3) {\n        _this.__draw();\n      }\n    };\n\n    // 资源文件\n    var skyImage = new Image();\n    var groundImage = new Image();\n    var playerImage = new Image();\n    var playerLeftImage = new Image();\n    var playerRightImage = new Image();\n    var playerDieImage = new Image();\n    var obstacleImage = new Image();\n\n    skyImage.onload = onImageLoaded;\n    groundImage.onload = onImageLoaded;\n    playerImage.onload = onImageLoaded;\n\n    skyImage.src = require('url-loader!./img/cloud.png');\n    groundImage.src = require('url-loader!./img/ground.png');\n    playerImage.src = require('url-loader!./img/dinosaur.png');\n    playerLeftImage.src = require('url-loader!./img/dinosaur_left.png');\n    playerRightImage.src = require('url-loader!./img/dinosaur_right.png');\n    playerDieImage.src = require('url-loader!./img/dinosaur_die.png');\n    obstacleImage.src = require('url-loader!./img/obstacle.png');\n\n    _this.options = _extends({\n      fps: 60,\n      skySpeed: 40,\n      groundSpeed: 100,\n      skyImage: skyImage,\n      groundImage: groundImage,\n      playerImage: [playerImage, playerLeftImage, playerRightImage, playerDieImage],\n      obstacleImage: obstacleImage,\n      skyOffset: 0,\n      groundOffset: 0\n    }, _this.props.options);\n\n    _this.status = STATUS.STOP;\n    _this.timer = null;\n    _this.score = 0;\n    _this.highScore = window.localStorage ? window.localStorage['highScore'] || 0 : 0;\n    _this.jumpHeight = 0;\n    _this.jumpDelta = 0;\n    _this.obstaclesBase = 1;\n    _this.obstacles = _this.__obstaclesGenerate();\n    _this.currentDistance = 0;\n    _this.playerStatus = 0;\n    return _this;\n  }\n\n  _createClass(Game, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (window.innerWidth >= 680) {\n        this.canvas.width = 680;\n      }\n\n      var onSpacePress = function onSpacePress() {\n        switch (_this2.status) {\n          case STATUS.STOP:\n            _this2.start();\n            break;\n          case STATUS.START:\n            _this2.jump();\n            break;\n          case STATUS.OVER:\n            _this2.restart();\n            break;\n        }\n      };\n\n      window.onkeypress = function (e) {\n        if (e.key === ' ') {\n          onSpacePress();\n        }\n      };\n      this.canvas.parentNode.onclick = onSpacePress;\n\n      window.onblur = this.pause;\n      window.onfocus = this.goOn;\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      window.onblur = null;\n      window.onfocus = null;\n    }\n  }, {\n    key: '__draw',\n    value: function __draw() {\n      if (!this.canvas) {\n        return;\n      }\n\n      var options = this.options;\n\n\n      var level = Math.min(200, Math.floor(this.score / 100));\n      var groundSpeed = (options.groundSpeed + level) / options.fps;\n      var skySpeed = options.skySpeed / options.fps;\n      var obstacleWidth = options.obstacleImage.width;\n      var playerWidth = options.playerImage[0].width;\n      var playerHeight = options.playerImage[0].height;\n\n      var ctx = this.canvas.getContext('2d');\n      var _canvas = this.canvas;\n      var width = _canvas.width;\n      var height = _canvas.height;\n\n\n      ctx.clearRect(0, 0, width, height);\n      ctx.save();\n\n      // 云\n      this.options.skyOffset = this.options.skyOffset < width ? this.options.skyOffset + skySpeed : this.options.skyOffset - width;\n      ctx.translate(-this.options.skyOffset, 0);\n      ctx.drawImage(this.options.skyImage, 0, 0);\n      ctx.drawImage(this.options.skyImage, this.options.skyImage.width, 0);\n\n      // 地面\n      this.options.groundOffset = this.options.groundOffset < width ? this.options.groundOffset + groundSpeed : this.options.groundOffset - width;\n      ctx.translate(this.options.skyOffset - this.options.groundOffset, 0);\n      ctx.drawImage(this.options.groundImage, 0, 76);\n      ctx.drawImage(this.options.groundImage, this.options.groundImage.width, 76);\n\n      // 恐龙\n      // 这里已经将坐标还原回左上角\n      ctx.translate(this.options.groundOffset, 0);\n      ctx.drawImage(this.options.playerImage[this.playerStatus], 80, 64 - this.jumpHeight);\n      // 更新跳跃高度/速度\n      this.jumpHeight = this.jumpHeight + this.jumpDelta;\n      if (this.jumpHeight <= 1) {\n        this.jumpHeight = 0;\n        this.jumpDelta = 0;\n      } else if (this.jumpHeight < JUMP_MAX_HEIGHT && this.jumpDelta > 0) {\n        this.jumpDelta = this.jumpHeight * this.jumpHeight * 0.001033 - this.jumpHeight * 0.137 + 5;\n      } else if (this.jumpHeight < JUMP_MAX_HEIGHT && this.jumpDelta < 0) {\n        // jumpDelta = (jumpHeight * jumpHeight) * 0.00023 - jumpHeight * 0.03 - 4;\n      } else if (this.jumpHeight >= JUMP_MAX_HEIGHT) {\n        this.jumpDelta = -JUMP_DELTA / 2.7;\n      }\n\n      // 分数\n      var scoreText = (this.status === STATUS.OVER ? 'GAME OVER  ' : '') + Math.floor(this.score);\n      ctx.font = \"Bold 18px Arial\";\n      ctx.textAlign = \"right\";\n      ctx.fillStyle = \"#595959\";\n      ctx.fillText(scoreText, width - 30, 23);\n      if (this.status === STATUS.START) {\n        this.score += 0.5;\n        if (this.score > this.highScore) {\n          this.highScore = this.score;\n          window.localStorage['highScore'] = this.score;\n        }\n        this.currentDistance += groundSpeed;\n        if (this.score % 4 === 0) {\n          this.playerStatus = (this.playerStatus + 1) % 3;\n        }\n      }\n      if (this.highScore) {\n        ctx.textAlign = \"left\";\n        ctx.fillText('HIGH  ' + Math.floor(this.highScore), 30, 23);\n      }\n\n      // 障碍\n      var pop = 0;\n      for (var i = 0; i < this.obstacles.length; ++i) {\n        if (this.currentDistance >= this.obstacles[i].distance) {\n          var offset = width - (this.currentDistance - this.obstacles[i].distance + groundSpeed);\n          if (offset > 0) {\n            ctx.drawImage(options.obstacleImage, offset, 84);\n          } else {\n            ++pop;\n          }\n        } else {\n          break;\n        }\n      }\n      for (var _i = 0; _i < pop; ++_i) {\n        this.obstacles.shift();\n      }\n      if (this.obstacles.length < 5) {\n        this.obstacles = this.obstacles.concat(this.__obstaclesGenerate());\n      }\n\n      // 碰撞检测\n      var firstOffset = width - (this.currentDistance - this.obstacles[0].distance + groundSpeed);\n      if (90 - obstacleWidth < firstOffset && firstOffset < 60 + playerWidth && 64 - this.jumpHeight + playerHeight > 84) {\n        this.stop();\n      }\n\n      ctx.restore();\n    }\n  }, {\n    key: '__obstaclesGenerate',\n    value: function __obstaclesGenerate() {\n      var res = [];\n      for (var i = 0; i < 10; ++i) {\n        var random = Math.floor(Math.random() * 100) % 60;\n        random = (Math.random() * 10 % 2 === 0 ? 1 : -1) * random;\n        res.push({\n          distance: random + this.obstaclesBase * 200\n        });\n        ++this.obstaclesBase;\n      }\n      return res;\n    }\n  }, {\n    key: '__setTimer',\n    value: function __setTimer() {\n      var _this3 = this;\n\n      this.timer = setInterval(function () {\n        return _this3.__draw();\n      }, 1000 / this.options.fps);\n    }\n  }, {\n    key: '__clearTimer',\n    value: function __clearTimer() {\n      if (this.timer) {\n        clearInterval(this.timer);\n        this.timer = null;\n      }\n    }\n  }, {\n    key: '__clear',\n    value: function __clear() {\n      this.score = 0;\n      this.jumpHeight = 0;\n      this.currentDistance = 0;\n      this.obstacles = [];\n      this.obstaclesBase = 1;\n      this.playerStatus = 0;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      return _react2.default.createElement('canvas', { id: 'canvas', ref: function ref(_ref) {\n          return _this4.canvas = _ref;\n        }, height: 160, width: 340 });\n    }\n  }]);\n\n  return Game;\n}(_react2.default.Component);\n\nexports.default = Game;\n;"]},"metadata":{},"sourceType":"script"}